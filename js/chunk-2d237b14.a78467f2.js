(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d237b14"],{fbce:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("layout-box",{attrs:{one:"用户管理",two:"角色列表"}},[r("el-card",{staticClass:"mb-1",attrs:{shadow:"never"}},[r("div",[r("i",{staticClass:"el-icon-search"}),r("span",[e._v("筛选搜索")]),r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleSearchList()}}},[e._v(" 查询结果 ")]),r("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small"},on:{click:e.handleResetSearch}},[e._v("重置")])],1),r("div",{staticClass:"mt-1"},[r("el-form",{attrs:{inline:!0,size:"small","label-width":"140px",model:e.queryInfo}},[r("el-form-item",{attrs:{label:"角色名称"}},[r("el-input",{attrs:{placeholder:"输入角色名称",clearable:""},on:{clear:e.fetch},model:{value:e.queryInfo.roleName,callback:function(t){e.$set(e.queryInfo,"roleName",t)},expression:"queryInfo.roleName"}})],1)],1)],1)]),r("el-button",{staticClass:"mb-1",attrs:{type:"primary",size:"small"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("新增角色")]),r("el-table",{attrs:{data:e.tableData,border:""}},[r("el-table-column",{attrs:{prop:"roleCode",align:"center",label:"角色编码",width:"100"}}),r("el-table-column",{attrs:{prop:"roleName",align:"center",label:"角色名称",width:"260"}}),r("el-table-column",{attrs:{prop:"createTime",align:"center",label:"创建时间"}}),r("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-row",[r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return e.handleSelectMenu(t.$index,t.row)}}},[e._v("分配权限 ")]),r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return e.handleSelectResource(t.id,t.row)}}},[e._v("分配用户 ")])],1),r("el-row",[r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return e.showEditDialog(t.row.id)}}},[e._v(" 编辑 ")]),r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return e.handleDelete(t.row.id)}}},[e._v("删除 ")])],1)]}}])})],1),r("div",{staticClass:"mt-1 text-right"},[r("el-pagination",{attrs:{background:"","current-page":e.queryInfo.pageNo,"page-sizes":[2,5,10,20],"page-size":e.queryInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{title:"添加角色",width:"30%",visible:e.addDialogVisible},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addDialogClosed}},[r("el-form",{ref:"addFormRef",attrs:{"label-width":"100px",model:e.addForm,rules:e.addFormRules}},[r("el-form-item",{attrs:{label:"角色编码",prop:"roleCode"}},[r("el-input",{attrs:{size:"small"},model:{value:e.addForm.roleCode,callback:function(t){e.$set(e.addForm,"roleCode",t)},expression:"addForm.roleCode"}})],1),r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{attrs:{size:"small"},model:{value:e.addForm.roleName,callback:function(t){e.$set(e.addForm,"roleName",t)},expression:"addForm.roleName"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addRole}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"编辑角色",width:"30%",visible:e.editDialogVisible},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editDialogClosed}},[r("el-form",{ref:"editFormRef",attrs:{"label-width":"100px",model:e.editForm,rules:e.editFormRules}},[r("el-form-item",{attrs:{label:"角色编码",prop:"roleCode"}},[r("el-input",{attrs:{size:"small"},model:{value:e.editForm.roleCode,callback:function(t){e.$set(e.editForm,"roleCode",t)},expression:"editForm.roleCode"}})],1),r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{attrs:{size:"small"},model:{value:e.editForm.roleName,callback:function(t){e.$set(e.editForm,"roleName",t)},expression:"editForm.roleName"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.editUserInfo}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"分配用户",visible:e.setRoleDialogVisible,width:"30%"},on:{"update:visible":function(t){e.setRoleDialogVisible=t},close:e.rolevisible}},[r("div",[e._l(e.userName,(function(t){return r("p",{key:t.id},[e._v("当前用户："+e._s(t.loginName))])})),r("p",[e._v("当前角色："+e._s(e.role.roleName))]),r("p",[e._v("分配用户 "),r("el-select",{staticStyle:{width:"80%"},attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择用户"},model:{value:e.userId,callback:function(t){e.userId=t},expression:"userId"}},e._l(e.rolesLsit,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],2),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.setRoleDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveRoleInfo}},[e._v("确 定")])],1)])],1)],1)},o=[],n=(r("6a61"),r("2e91")),i={pageNo:1,pageSize:10,roleName:null},s={data:function(){return{setRoleDialogVisible:!1,addFormRules:{roleName:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:10,message:"用户名的长度在3~10个字符之间",trigger:"blur"}],roleCode:[{required:!0,message:"请输入编码",trigger:"blur"},{min:3,max:10,message:"用户名的长度在3~10个字符之间",trigger:"blur"}]},editFormRules:{roleName:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:10,message:"用户名的长度在2~10个字符之间",trigger:"blur"}],roleCode:[{required:!0,message:"请输入编码",trigger:"blur"},{min:3,max:10,message:"用户名的长度在3~10个字符之间",trigger:"blur"}]},addForm:{roleName:"",roleCode:""},editForm:{},addDialogVisible:!1,editDialogVisible:!1,tableData:[],enableStatus:null,queryInfo:Object.assign({},i),total:0,rolesLsit:[],userId:"",roleId:"",role:"",userName:[]}},created:function(){this.fetch()},methods:{handleSelectResource:function(e,t){var r=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.role=t,r.roleId=t.id,e.next=4,r.$http.post("/woho/sys/userRole/findByRoleId/".concat(t.id));case 4:return a=e.sent,r.userName=a.data,e.next=8,r.$http.post("/woho/sys/user/query",r.queryInfo);case 8:o=e.sent,r.setRoleDialogVisible=!0,r.rolesLsit=o.data.data.list;case 11:case"end":return e.stop()}}),e)})))()},rolevisible:function(){this.userId=""},saveRoleInfo:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.userId){t.next=2;break}return t.abrupt("return",e.$message.error("请选择要分配的用户"));case 2:return t.next=4,e.$http.post("/woho/sys/userRole/findByRoleId/".concat(e.roleId));case 4:r=t.sent,200!==r.data.code?(e.$message.success("分配用户成功"),e.setRoleDialogVisible=!1):e.$message.error(r.data.msg);case 6:case"end":return t.stop()}}),t)})))()},fetch:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/woho/sys/role/query",e.queryInfo);case 2:r=t.sent,e.tableData=r.data.data.list,e.total=r.data.data.total;case 5:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.queryInfo.pageSize=e,this.fetch()},handleCurrentChange:function(e){console.log(e),this.queryInfo.pageNo=e,this.fetch()},addDialogClosed:function(){this.$refs.addFormRef.resetFields()},addRole:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.addFormRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("资料填写完整"));case 2:return t.next=4,e.$http.post("/woho/sys/role/insert",e.addForm);case 4:a=t.sent,a.data.success?(e.$message.success("添加角色成功！"),e.addDialogVisible=!1,e.fetch()):e.$message.error(a.data.msg);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},handleDelete:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(a=r.sent,"confirm"===a){r.next=5;break}return r.abrupt("return",t.$message.info("已取消删除"));case 5:return r.next=7,t.$http.delete("/woho/sys/role/delete/"+e);case 7:if(o=r.sent,200===o.data.code){r.next=10;break}return r.abrupt("return",t.$message.error("删除角色失败！"));case 10:t.$message.success("删除角色成功！"),t.fetch();case 12:case"end":return r.stop()}}),r)})))()},showEditDialog:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$http.post("/woho/sys/role/findById/"+e);case 2:a=r.sent,t.editForm=a.data,t.editDialogVisible=!0;case 5:case"end":return r.stop()}}),r)})))()},editDialogClosed:function(){this.$refs.editFormRef.resetFields()},editUserInfo:function(){var e=this;this.$refs.editFormRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("请填写完整"));case 2:return t.next=4,e.$http.put("/woho/sys/role/update",e.editForm);case 4:if(a=t.sent,200===a.data.code){t.next=7;break}return t.abrupt("return",e.$message.error("更新用户信息失败！"));case 7:e.$message.success("更改用户信息成功"),e.editDialogVisible=!1,e.fetch();case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleSelectMenu:function(e,t){this.$router.push({path:"/role/menu",query:{roleId:t.id}})},handleSearchList:function(){this.queryInfo.pageNo=1,this.fetch()},handleResetSearch:function(){this.queryInfo=Object.assign({},i),this.fetch()}}},l=s,u=r("5d22"),c=Object(u["a"])(l,a,o,!1,null,null,null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-2d237b14.a78467f2.js.map