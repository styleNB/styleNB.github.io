(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-181db3e1"],{"345c":function(e,t,a){},4699:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("LayoutBox",{attrs:{one:"新增活动"}},[a("h4",[e._v("商品介绍")]),a("el-form",{ref:"form",attrs:{"label-width":"100px",model:e.form,rules:e.rules,size:"small"}},[a("el-form-item",{attrs:{label:"套餐名称",required:""}},[a("el-input",{staticStyle:{width:"454px"},attrs:{maxlength:"30","show-word-limit":""},model:{value:e.teamForm.spellGroupName,callback:function(t){e.$set(e.teamForm,"spellGroupName",t)},expression:"teamForm.spellGroupName"}})],1),a("el-form-item",{attrs:{label:"活动时间",required:""}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.activeTime,callback:function(t){e.activeTime=t},expression:"activeTime"}})],1),a("el-form-item",{attrs:{label:"活动折扣率",required:""}},[a("el-input",{staticStyle:{width:"454px"},model:{value:e.teamForm.discount,callback:function(t){e.$set(e.teamForm,"discount",t)},expression:"teamForm.discount"}},[a("template",{slot:"append"},[e._v("%")])],2)],1),a("el-form-item",{attrs:{label:"拼团人数",required:""}},[a("el-input",{staticStyle:{width:"454px"},model:{value:e.teamForm.numPeople,callback:function(t){e.$set(e.teamForm,"numPeople",t)},expression:"teamForm.numPeople"}})],1),a("el-form-item",{attrs:{label:"套餐描述",required:""}},[a("el-input",{staticStyle:{width:"454px"},model:{value:e.teamForm.activeDescribes,callback:function(t){e.$set(e.teamForm,"activeDescribes",t)},expression:"teamForm.activeDescribes"}})],1),a("el-form-item",{attrs:{label:"套餐图片",required:""}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http-request","http-request":e.uploadSectionFile,"show-file-list":!1}},[e.teamForm.imgUrl?a("el-image",{staticClass:"avatar",attrs:{src:e.teamForm.imgUrl,fit:"contain"}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1)],1)],1),e.blUpdata?a("el-card",{staticClass:"box-card"},[a("h4",[e._v("已关联商品")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.oldGoodsAndActivity}},[a("el-table-column",{attrs:{prop:"name",label:"商品名称"}}),a("el-table-column",{attrs:{prop:"shopId",label:"供应商"}}),a("el-table-column",{attrs:{prop:"originalPrice",label:"销售价（元）"}}),a("el-table-column",{attrs:{label:"成团人数"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.oldUpdateIndex===t.$index?a("el-input"):a("p",[e._v(e._s(t.row.amount))])]}}],null,!1,2170474742)}),a("el-table-column",{attrs:{prop:"date",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.oldUpdateIndex===t.$index?a("el-button",{attrs:{type:"text"},on:{click:e.onOldSave}},[e._v("完成")]):a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){return a.preventDefault(),e.onOldUpdate(t)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text"}},[e._v("删除")])]}}],null,!1,2048600996)})],1),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.goodsTotle},on:{"current-change":e.handleCurrentChange}})],1):e._e(),a("el-card",{staticClass:"box-card"},[a("h4",[e._v("新增关联商品")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.goodsAndActivity}},[a("el-table-column",{attrs:{prop:"name",label:"商品名称"}}),a("el-table-column",{attrs:{prop:"originalPrice",label:"销售价（元）"}}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.onDelete(t)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"add_goods_btn"},[a("el-button",{staticClass:"add_goods",attrs:{type:"text",icon:"el-icon-plus"},nativeOn:{click:function(t){return t.preventDefault(),e.onAddGoods(t)}}},[e._v("添加商品")])],1),a("el-divider"),a("div",{staticClass:"btn_group"},[e.blUpdata?a("el-button",{staticClass:"inquire",attrs:{type:"success",size:"medium"},on:{click:e.save_btn}},[e._v("保存")]):a("el-button",{staticClass:"inquire",attrs:{type:"success",size:"medium"},on:{click:e.submit_btn}},[e._v("提交")]),a("router-link",{attrs:{to:"/super/market/team_buy/list"}},[a("el-button",{staticStyle:{width:"112px"},attrs:{size:"medium"}},[e._v("取消")])],1)],1)],1),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,fullscreen:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("AddGoodsCmp",{ref:"AddGoodsCmp"}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{round:""},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"danger",round:""},on:{click:function(t){return e.addAll()}}},[e._v("添 加")])],1)],1),a("image-compressor-cmp",{ref:"imageCompressorCmp"})],1)},s=[],o=(a("7f64"),a("957b"),a("d211")),i=(a("6a61"),a("2e91")),n=a("1b00"),l=a("28c8"),c=a("e49c"),u=a("a937"),m=a("46af"),d=a("5b19"),p=a("d901"),b={name:"AddTeamBuy",components:{LayoutBox:n["a"],AddGoodsCmp:l["a"],imageCompressorCmp:p["a"]},data:function(){return{activeType:0,activeTime:"",teamForm:{spellGroupName:"",spellGroupTime:24,activityStart:"",activityStop:"",discount:"",activeDescribes:"",numPeople:"",imgUrl:""}}},mixins:[c["a"],u["a"],m["a"],d["a"]],watch:{activeTime:function(e){this.teamForm.activityStart=e[0],this.teamForm.activityStop=e[1]}},methods:{submit_btn:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.goodsAndActivity.map((function(e){return e.id})),r=Object(o["a"])({smallProdId:a.join(",")},e.teamForm),!(e.goodsAndActivity.length<1)){t.next=5;break}return e.$message.error("请先选择添加商品"),t.abrupt("return");case 5:if(!e._formRules()){t.next=10;break}return t.next=8,e.$http.post(e.$api.insertSmallSpellGroup,r);case 8:s=t.sent,s.data.success?(e.$message.success("成功发布活动"),e.$router.push("/super/market/team_buy/list")):e.$message.error(s.data.msg);case 10:case"end":return t.stop()}}),t)})))()},save_btn:function(){var e=this;this._formRules()&&this.apiUpdateMerActivity().then((function(t){t.data.success?(e.$message.success("更新活动成功"),e.$router.push("/super/market/team_buy/list")):e.$message.error(t.data.msg)}))},uploadSectionFile:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t._uploadSectionFile(e);case 2:r=a.sent,r&&t._upload(r).then((function(e){t.teamForm.imgUrl=e}));case 4:case"end":return a.stop()}}),a)})))()},_uploadSectionFile:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,s,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r="image/jpeg"===e.file.type||"image/png"===e.file.type,s=e.file.size/1024/1024<10,r){a.next=5;break}return t.$message.error("上传图片只能是 JPG/PNG 格式!"),a.abrupt("return",!1);case 5:if(s){a.next=8;break}return t.$message.error("上传图片大小不能超过 10MB!"),a.abrupt("return",!1);case 8:return console.log(222222),a.next=11,t.$refs.imageCompressorCmp._imageCompressor(e.file);case 11:return o=a.sent,a.abrupt("return",o);case 13:case"end":return a.stop()}}),a)})))()},_upload:function(e){return this.$http.post("/common/oss/uploadFile",e).then((function(e){return e.data.data.webUrl}))}}},f=b,v=(a("cdc7"),a("5d22")),g=Object(v["a"])(f,r,s,!1,null,"5efac5a8",null);t["default"]=g.exports},cdc7:function(e,t,a){"use strict";a("345c")}}]);
//# sourceMappingURL=chunk-181db3e1.9c478511.js.map