(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f20e249c"],{b4e6:function(e,t,a){"use strict";var i=a("bbcf"),r=a("5501"),s=a("285a"),o=a("5152"),l=a("529d"),n=a("5c1e"),m=a("7389"),c=a("780c"),p=a("e9a9"),u=c("splice"),d=p("splice",{ACCESSORS:!0,0:0,1:2}),g=Math.max,h=Math.min,y=9007199254740991,f="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!u||!d},{splice:function(e,t){var a,i,c,p,u,d,v=l(this),b=o(v.length),F=r(e,b),T=arguments.length;if(0===T?a=i=0:1===T?(a=0,i=b-F):(a=T-2,i=h(g(s(t),0),b-F)),b+a-i>y)throw TypeError(f);for(c=n(v,i),p=0;p<i;p++)u=F+p,u in v&&m(c,p,v[u]);if(c.length=i,a<i){for(p=F;p<b-i;p++)u=p+i,d=p+a,u in v?v[d]=v[u]:delete v[d];for(p=b;p>b-i+a;p--)delete v[p-1]}else if(a>i)for(p=b-i;p>F;p--)u=p+i-1,d=p+a-1,u in v?v[d]=v[u]:delete v[d];for(p=0;p<a;p++)v[p+F]=arguments[p+2];return v.length=b-i+a,c}})},bdf7:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("LayoutBox",{attrs:{one:"新增活动"}},[a("el-button",{attrs:{type:"warning",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.onBargains(t)}}},[e._v("秒杀")]),a("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.onTeamBuy(t)}}},[e._v("团购")]),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.activeType,expression:"activeType == 1"}],staticClass:"form_box"},[a("h4",[e._v("活动介绍")]),a("el-form",{ref:"bargainsForm",attrs:{"label-width":"140px",model:e.bargainsForm,rules:e.bargainsFormRules,size:"mini"}},[a("el-form-item",{attrs:{label:"秒杀标题",prop:"activeName"}},[a("el-input",{attrs:{maxlength:"30","show-word-limit":""},model:{value:e.bargainsForm.activeName,callback:function(t){e.$set(e.bargainsForm,"activeName",t)},expression:"bargainsForm.activeName"}})],1),a("el-form-item",{attrs:{label:"秒杀图片",required:""}},[a("el-upload",{attrs:{action:"123","http-request":e.onBargainsUpload,"on-remove":e.handleRemove,"list-type":"picture-card","file-list":e.bargainsForm.imageUrl,limit:1}},[a("i",{staticClass:"el-icon-plus"})])],1),a("el-form-item",{attrs:{label:"活动报名开始时间",prop:"applyStartTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"活动报名开始时间"},model:{value:e.bargainsForm.applyStartTime,callback:function(t){e.$set(e.bargainsForm,"applyStartTime",t)},expression:"bargainsForm.applyStartTime"}})],1),a("el-form-item",{attrs:{label:"活动报名结束时间",prop:"applyEndTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"活动报名结束时间"},model:{value:e.bargainsForm.applyEndTime,callback:function(t){e.$set(e.bargainsForm,"applyEndTime",t)},expression:"bargainsForm.applyEndTime"}})],1),a("el-form-item",{attrs:{label:"活动开始时间",prop:"startTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"活动开始时间"},model:{value:e.bargainsForm.startTime,callback:function(t){e.$set(e.bargainsForm,"startTime",t)},expression:"bargainsForm.startTime"}})],1),a("el-form-item",{attrs:{label:"活动结束时间",prop:"endTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"活动结束时间"},model:{value:e.bargainsForm.endTime,callback:function(t){e.$set(e.bargainsForm,"endTime",t)},expression:"bargainsForm.endTime"}})],1),a("el-form-item",{attrs:{label:"秒杀折扣率",prop:"discountRate"}},[a("el-input",{model:{value:e.bargainsForm.discountRate,callback:function(t){e.$set(e.bargainsForm,"discountRate",t)},expression:"bargainsForm.discountRate"}}),a("span",{staticClass:"mark"},[e._v("例：5折，填写 0.5 即可")])],1),a("el-form-item",{attrs:{label:"活动规则",prop:"activeDescribe"}},[a("el-input",{attrs:{type:"textarea",maxlength:"50","show-word-limit":""},model:{value:e.bargainsForm.activeDescribe,callback:function(t){e.$set(e.bargainsForm,"activeDescribe",t)},expression:"bargainsForm.activeDescribe"}})],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:0==e.activeType,expression:"activeType == 0"}],staticClass:"form_box"},[a("h4",[e._v("活动介绍")]),a("el-form",{ref:"teamBuyForm",attrs:{"label-width":"140px",size:"mini",model:e.teamBuyForm,rules:e.teamBuyFormRules}},[a("el-form-item",{attrs:{label:"拼团标题",prop:"activeName"}},[a("el-input",{attrs:{maxlength:"30","show-word-limit":""},model:{value:e.teamBuyForm.activeName,callback:function(t){e.$set(e.teamBuyForm,"activeName",t)},expression:"teamBuyForm.activeName"}})],1),a("el-form-item",{attrs:{label:"拼团图片",required:""}},[a("el-upload",{attrs:{action:"123","http-request":e.onTeamBuyUpload,"on-remove":e.handleRemove,"list-type":"picture-card","file-list":e.teamBuyForm.imageUrl,limit:1}},[a("i",{staticClass:"el-icon-plus"})])],1),a("el-form-item",{attrs:{label:"活动报名开始时间",prop:"applyStartTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"活动报名开始时间"},model:{value:e.teamBuyForm.applyStartTime,callback:function(t){e.$set(e.teamBuyForm,"applyStartTime",t)},expression:"teamBuyForm.applyStartTime"}})],1),a("el-form-item",{attrs:{label:"活动报名结束时间",prop:"applyEndTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"活动报名结束时间"},model:{value:e.teamBuyForm.applyEndTime,callback:function(t){e.$set(e.teamBuyForm,"applyEndTime",t)},expression:"teamBuyForm.applyEndTime"}})],1),a("el-form-item",{attrs:{label:"活动开始时间",prop:"startTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"活动开始时间"},model:{value:e.teamBuyForm.startTime,callback:function(t){e.$set(e.teamBuyForm,"startTime",t)},expression:"teamBuyForm.startTime"}})],1),a("el-form-item",{attrs:{label:"活动结束时间",prop:"endTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"活动结束时间"},model:{value:e.teamBuyForm.endTime,callback:function(t){e.$set(e.teamBuyForm,"endTime",t)},expression:"teamBuyForm.endTime"}})],1),a("el-form-item",{attrs:{label:"团购折扣率",prop:"discountRate"}},[a("el-input",{model:{value:e.teamBuyForm.discountRate,callback:function(t){e.$set(e.teamBuyForm,"discountRate",t)},expression:"teamBuyForm.discountRate"}}),a("span",{staticClass:"mark"},[e._v("例：5折，填写 0.5 即可")])],1),a("el-form-item",{attrs:{label:"成团人数",prop:"groupPeople"}},[a("el-input",{model:{value:e.teamBuyForm.groupPeople,callback:function(t){e.$set(e.teamBuyForm,"groupPeople",t)},expression:"teamBuyForm.groupPeople"}})],1),a("el-form-item",{attrs:{label:"活动规则",prop:"activeDescribe"}},[a("el-input",{attrs:{type:"textarea",maxlength:"50","show-word-limit":""},model:{value:e.teamBuyForm.activeDescribe,callback:function(t){e.$set(e.teamBuyForm,"activeDescribe",t)},expression:"teamBuyForm.activeDescribe"}})],1)],1)],1),a("div",{staticStyle:{"text-align":"center"}},[e.$route.query.id?a("el-button",{staticClass:"inquire1",staticStyle:{width:"80px"},attrs:{type:"success",size:"small"},on:{click:e.onUpdate}},[e._v("编辑")]):a("el-button",{staticClass:"inquire1",staticStyle:{width:"80px"},attrs:{type:"success",size:"small"},on:{click:e.submitForm}},[e._v("保存")]),a("router-link",{attrs:{to:"/adminActivityList"}},[a("el-button",{staticStyle:{width:"80px"},attrs:{size:"small"}},[e._v("取消")])],1)],1)],1)],1)},r=[],s=(a("957b"),a("b4e6"),a("1b00")),o={name:"AddActivity",components:{LayoutBox:s["a"]},data:function(){return{type:0,activeType:1,dialogVisible:!1,parentId:0,classification:[],childClassificationList:[],childClassificationIndex:"",bargainsForm:{activeName:"",applyStartTime:"",applyEndTime:"",startTime:"",endTime:"",discountRate:"",activeDescribe:"",imageUrl:[]},bargainsFormRules:{activeName:[{required:!0,message:"请输入秒杀标题",trigger:"chang"}],applyStartTime:[{required:!0,message:"请选择开始报名时间",trigger:"chang"}],applyEndTime:[{required:!0,message:"请选择结束报名时间",trigger:"chang"}],startTime:[{required:!0,message:"开始时间",trigger:"chang"}],endTime:[{required:!0,message:"结束时间",trigger:"chang"}],discountRate:[{required:!0,message:"请输入秒杀折扣率",trigger:"chang"}],activeDescribe:[{required:!0,message:"请输入活动规则",trigger:"chang"}]},teamBuyForm:{activeName:"",applyStartTime:"",applyEndTime:"",startTime:"",endTime:"",discountRate:"",activeDescribe:"",imageUrl:[],groupPeople:""},teamBuyFormRules:{activeName:[{required:!0,message:"请输入团购标题",trigger:"chang"}],applyStartTime:[{required:!0,message:"请选择开始报名时间",trigger:"chang"}],applyEndTime:[{required:!0,message:"请选择结束报名时间",trigger:"chang"}],startTime:[{required:!0,message:"开始时间",trigger:"chang"}],endTime:[{required:!0,message:"结束时间",trigger:"chang"}],discountRate:[{required:!0,message:"请输入团购折扣率",trigger:"chang"}],activeDescribe:[{required:!0,message:"请输入活动规则",trigger:"chang"}],groupPeople:[{required:!0,message:"请输入拼团人数",trigger:"chang"}]}}},methods:{onBargains:function(){this.$refs.bargainsForm.resetFields(),this.activeType=1},onTeamBuy:function(){this.$refs.teamBuyForm.resetFields(),this.activeType=0},save:function(){this.childClassificationList=this.$refs.classificationCmp.childClassificationList,this.dialogVisible=!1},onChildClassification:function(e){this.childClassificationIndex=e},onDelete:function(){this.childClassificationList.splice(this.childClassificationIndex,1)},onBargainsUpload:function(e){var t=this;this._uploadSectionFile(e).then((function(e){t.bargainsForm.imageUrl=[{url:e}]}))},onTeamBuyUpload:function(e){var t=this;this._uploadSectionFile(e).then((function(e){t.teamBuyForm.imageUrl=[{url:e}]}))},submitForm:function(){switch(this.activeType){case 0:var e=this._submitForm("teamBuyForm");e&&this.apiAddActivity(e);break;case 1:var t=this._submitForm("bargainsForm");t&&this.apiAddActivity(t);break}},onUpdate:function(){switch(this.activeType){case 0:var e=this._submitForm("teamBuyForm");e&&this.apiUpdateActivity(e);break;case 1:var t=this._submitForm("bargainsForm");t&&this.apiUpdateActivity(t);break}},handleRemove:function(){switch(this.activeType){case 0:this.teamBuyForm.imageUrl=[];break;case 1:this.bargainsForm.imageUrl=[];break}},_submitForm:function(e){var t=this,a=!1;return this.$refs[e].validate((function(i){return i?(a=Object.assign({},t[e]),0===a.imageUrl.length?(t.$message.error("请选择图片"),a=!1,!1):(a.type=t.type,a.activeType=t.activeType,a.imageUrl=a.imageUrl[0].url,a.rel=t.childClassificationList,a.rel.map((function(e){return e.categoryId=e.id})),a)):(a=!1,!1)})),a},_findByParentId:function(){var e=this;this.$http.post("/woho/product/category/findByParentId/"+this.parentId).then((function(t){e.classification=t.data}))},apiAddActivity:function(e){var t=this;console.log(e),this.$http.post("/woho/activity/manage/insert",e).then((function(e){console.log(e),e.data.success?(t.$message.success("活动添加成功"),t.$router.push("/adminActivityList")):t.$message.error(e.data.msg)}))},apiUpdateActivity:function(e){var t=this;console.log(e),this.$http.post("/woho/activity/manage/update",e).then((function(e){console.log(e),e.data.success?(t.$message.success("活动编辑成功"),t.$router.push("/adminActivityList")):t.$message.error(e.data.msg)}))},_uploadSectionFile:function(e){var t="image/jpeg"===e.file.type||"image/png"===e.file.type,a=e.file.size/1024/1024<10;if(t){if(a){var i=new FormData;return i.append("file",e.file),this.$http.post("/common/oss/uploadFile",i).then((function(e){return e.data.data.webUrl}))}this.$message.error("上传图片大小不能超过 10MB!")}else this.$message.error("上传图片只能是 JPG/PNG 格式!")},apiFindByIdActivity:function(){var e=this;this.$http.post("/woho/activity/manage/findById/".concat(this.$route.query.id)).then((function(t){if(0===t.data.activeType){e.activeType=0;var a=JSON.stringify(t.data);a=JSON.parse(a),a.imageUrl=[],a.imageUrl.push({url:t.data.imageUrl}),e.teamBuyForm=a}else if(1===t.data.activeType){e.activeType=1;var i=JSON.stringify(t.data);i=JSON.parse(i),i.imageUrl=[],i.imageUrl.push({url:t.data.imageUrl}),e.bargainsForm=i}}))}},created:function(){this._findByParentId(),this.$route.query.id&&this.apiFindByIdActivity()}},l=o,n=(a("c95a"),a("5d22")),m=Object(n["a"])(l,i,r,!1,null,"1d42876e",null);t["default"]=m.exports},c95a:function(e,t,a){"use strict";a("f543")},f543:function(e,t,a){}}]);
//# sourceMappingURL=chunk-f20e249c.dbe3aa17.js.map