{"version":3,"sources":["webpack:///./node_modules/_core-js@3.8.2@core-js/modules/es.array.index-of.js","webpack:///./src/views/admin_activity/marketing_activities/add.vue?8802","webpack:///./src/views/admin_activity/cmp/add_goods_cmp.vue?5178","webpack:///src/views/admin_activity/cmp/add_goods_cmp.vue","webpack:///./src/views/admin_activity/cmp/add_goods_cmp.vue?adf6","webpack:///./src/views/admin_activity/cmp/add_goods_cmp.vue","webpack:///src/views/admin_activity/marketing_activities/add.vue","webpack:///./src/views/admin_activity/marketing_activities/add.vue?1506","webpack:///./src/views/admin_activity/marketing_activities/add.vue","webpack:///./src/views/admin_activity/marketing_activities/add.vue?ddb9"],"names":["$","$indexOf","indexOf","arrayMethodIsStrict","arrayMethodUsesToLength","nativeIndexOf","NEGATIVE_ZERO","STRICT_METHOD","USES_TO_LENGTH","ACCESSORS","1","target","proto","forced","searchElement","apply","this","arguments","length","undefined","render","_vm","_h","$createElement","_c","_self","attrs","$route","query","id","ref","activity","rules","model","value","callback","$$v","$set","expression","activityTime","onUpload","onRemove","background","staticClass","onUploadIcon","onRemoveIcon","icon","_v","on","onSource","_l","item","key","name","type","_e","ruleName","scope","activityData","onCouponsSubmit","onCouponsSave","slot","staticStyle","goodsList","scopedSlots","_u","fn","row","$event","onActiveTime","onDelete","addGoodsVisible","onSave","onSubmit","onClose","onSelectGoods","staticRenderFns","dialogTableVisible","handleSelectionChange","queryInit","pageNo","pageSize","total","handleSizeChange","handleCurrentChange","onAdd","props","data","selectGoodsList","watch","newVal","apiProductQuery","created","methods","$emit","console","log","e","component","components","LayoutBox","addGoodsCmp","activityAddCmp","imageCompressorCmp","mixins","activityBeginTime","activityEndTime","shopModule","activityType","couponRules","newvalue","forEach","goodIdList","element","produId","activeTime","splice","$index","_formValidate","$message","error","isFormValidate","map","SyntaxError","$refs","ruleForm","validate","valid"],"mappings":"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","file":"js/chunk-c4b77396.b47e9c55.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.es/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('layout-box',{attrs:{\"one\":_vm.$route.query.id ? '编辑活动' : '新增活动'}},[_c('el-form',{ref:\"ruleForm\",attrs:{\"label-width\":\"100px\",\"size\":\"small\",\"model\":_vm.activity,\"rules\":_vm.rules}},[_c('el-form-item',{attrs:{\"label\":\"活动名称：\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.activity.name),callback:function ($$v) {_vm.$set(_vm.activity, \"name\", $$v)},expression:\"activity.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"活动时间：\",\"prop\":\"activityBeginTime\"}},[_c('el-date-picker',{attrs:{\"type\":\"datetimerange\",\"range-separator\":\"至\",\"start-placeholder\":\"开始日期\",\"end-placeholder\":\"结束日期\"},model:{value:(_vm.activityTime),callback:function ($$v) {_vm.activityTime=$$v},expression:\"activityTime\"}})],1),_c('el-form-item',{attrs:{\"label\":\"活动背景图：\"}},[_c('el-upload',{attrs:{\"action\":\"http-request\",\"http-request\":_vm.onUpload,\"list-type\":\"picture-card\",\"on-remove\":_vm.onRemove,\"file-list\":_vm.activity.background,\"limit\":1,\"multiple\":\"\"}},[_c('i',{staticClass:\"el-icon-plus\"})])],1),_c('el-form-item',{attrs:{\"label\":\"角标：\"}},[_c('el-upload',{attrs:{\"action\":\"http-request\",\"http-request\":_vm.onUploadIcon,\"list-type\":\"picture-card\",\"on-remove\":_vm.onRemoveIcon,\"file-list\":_vm.activity.icon,\"limit\":1,\"multiple\":\"\"}},[_c('i',{staticClass:\"el-icon-plus\"})])],1),_c('el-form-item',{attrs:{\"label\":\"是否显示在页面上：\",\"prop\":\"scope\"}},[_c('el-radio',{attrs:{\"label\":0},model:{value:(_vm.activity.shopModule),callback:function ($$v) {_vm.$set(_vm.activity, \"shopModule\", $$v)},expression:\"activity.shopModule\"}},[_vm._v(\"否\")]),_c('el-radio',{attrs:{\"label\":1},model:{value:(_vm.activity.shopModule),callback:function ($$v) {_vm.$set(_vm.activity, \"shopModule\", $$v)},expression:\"activity.shopModule\"}},[_vm._v(\"是\")])],1),_c('el-form-item',{attrs:{\"label\":\"适用范围：\",\"prop\":\"scope\"}},[_c('el-radio-group',{on:{\"change\":_vm.onSource},model:{value:(_vm.activity.scope),callback:function ($$v) {_vm.$set(_vm.activity, \"scope\", $$v)},expression:\"activity.scope\"}},[_c('el-radio',{attrs:{\"label\":\"0\"}},[_vm._v(\"所有商城\")]),_c('el-radio',{attrs:{\"label\":\"2\"}},[_vm._v(\"所有小超\")]),_c('el-radio',{attrs:{\"label\":\"4\"}},[_vm._v(\"平台\")]),_c('el-radio',{attrs:{\"label\":\"5\"}},[_vm._v(\"自营店铺\")])],1)],1),(_vm.activity.scope)?_c('el-form-item',{attrs:{\"label\":\"活动分类：\",\"prop\":\"type\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.activity.type),callback:function ($$v) {_vm.$set(_vm.activity, \"type\", $$v)},expression:\"activity.type\"}},_vm._l((_vm.activityType),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.name,\"value\":item.type}})}),1)],1):_vm._e(),(_vm.activity.scope)?_c('el-form-item',{attrs:{\"label\":\"活动适用对象：\",\"prop\":\"rules\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.activity.rules),callback:function ($$v) {_vm.$set(_vm.activity, \"rules\", $$v)},expression:\"activity.rules\"}},_vm._l((_vm.couponRules),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.ruleName,\"value\":item.rules}})}),1)],1):_vm._e()],1)],1),(_vm.activity.type === 1)?_c('el-card',{staticClass:\"goods_ground\"},[_c('activity-add-cmp',{attrs:{\"activityScope\":_vm.activity.scope,\"activityData\":_vm.activityData},on:{\"onSubmit\":_vm.onCouponsSubmit,\"onSave\":_vm.onCouponsSave}})],1):(_vm.activity.type === 2)?_c('el-card',{staticClass:\"goods_ground\"},[_c('div',{attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"选择的商品\")])]),_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.goodsList,\"size\":\"mini\"}},[_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"名称\",\"show-overflow-tooltip\":\"\"}}),_c('el-table-column',{attrs:{\"label\":\"原价\",\"width\":\"150\"},scopedSlots:_vm._u([{key:\"default\",fn:function(slot){return [_c('el-input',{attrs:{\"size\":\"mini\"},model:{value:(slot.row.produPrice),callback:function ($$v) {_vm.$set(slot.row, \"produPrice\", $$v)},expression:\"slot.row.produPrice\"}},[_c('template',{slot:\"append\"},[_vm._v(\"元\")])],2)]}}])}),_c('el-table-column',{attrs:{\"label\":\"活动价格\",\"width\":\"150\"},scopedSlots:_vm._u([{key:\"default\",fn:function(slot){return [_c('el-input',{attrs:{\"size\":\"mini\"},model:{value:(slot.row.activePrice),callback:function ($$v) {_vm.$set(slot.row, \"activePrice\", $$v)},expression:\"slot.row.activePrice\"}},[_c('template',{slot:\"append\"},[_vm._v(\"元\")])],2)]}}])}),_c('el-table-column',{attrs:{\"label\":\"需要几人成功\",\"width\":\"130\"},scopedSlots:_vm._u([{key:\"default\",fn:function(slot){return [_c('el-input',{attrs:{\"size\":\"mini\"},model:{value:(slot.row.clustersNumber),callback:function ($$v) {_vm.$set(slot.row, \"clustersNumber\", $$v)},expression:\"slot.row.clustersNumber\"}},[_c('template',{slot:\"append\"},[_vm._v(\"人\")])],2)]}}])}),_c('el-table-column',{attrs:{\"label\":\"活动持续时间\",\"width\":\"350\"},scopedSlots:_vm._u([{key:\"default\",fn:function(slot){return [_c('div',{staticClass:\"goods_time\"},[_c('el-input',{attrs:{\"size\":\"mini\"},on:{\"input\":function($event){return _vm.onActiveTime(slot)}},model:{value:(slot.row.activeTimeDay),callback:function ($$v) {_vm.$set(slot.row, \"activeTimeDay\", $$v)},expression:\"slot.row.activeTimeDay\"}},[_c('template',{slot:\"append\"},[_vm._v(\"天\")])],2),_c('el-input',{attrs:{\"size\":\"mini\"},on:{\"input\":function($event){return _vm.onActiveTime(slot)}},model:{value:(slot.row.activeTimeHour),callback:function ($$v) {_vm.$set(slot.row, \"activeTimeHour\", $$v)},expression:\"slot.row.activeTimeHour\"}},[_c('template',{slot:\"append\"},[_vm._v(\"时\")])],2),_c('el-input',{attrs:{\"size\":\"mini\"},on:{\"input\":function($event){return _vm.onActiveTime(slot)}},model:{value:(slot.row.activeTimeMin),callback:function ($$v) {_vm.$set(slot.row, \"activeTimeMin\", $$v)},expression:\"slot.row.activeTimeMin\"}},[_c('template',{slot:\"append\"},[_vm._v(\"分\")])],2)],1)]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(slot){return [_c('el-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){return _vm.onDelete(slot)}}},[_vm._v(\"删除\")])]}}])})],1),_c('div',{staticClass:\"add\",on:{\"click\":function($event){_vm.addGoodsVisible = true}}},[_c('i',{staticClass:\"el-icon-plus\"}),_c('span',[_vm._v(\"添加商品类目\")])]),(_vm.$route.query.id)?_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onSave}},[_vm._v(\"保存\")]):_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onSubmit}},[_vm._v(\"添加\")])],1):_vm._e(),_c('addGoods-cmp',{attrs:{\"addGoodsVisible\":_vm.addGoodsVisible},on:{\"close\":_vm.onClose,\"selectGoods\":_vm.onSelectGoods}}),_c('image-compressor-cmp',{ref:\"imageCompressorCmp\"})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{attrs:{\"fullscreen\":\"\",\"title\":\"商品列表\",\"visible\":_vm.dialogTableVisible},on:{\"update:visible\":function($event){_vm.dialogTableVisible=$event},\"close\":_vm.onClose}},[_c('el-table',{attrs:{\"data\":_vm.goodsList,\"size\":\"small\"},on:{\"selection-change\":_vm.handleSelectionChange}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"width\":\"55\"}}),_c('el-table-column',{attrs:{\"property\":\"name\",\"label\":\"名称\"}})],1),_c('el-pagination',{staticClass:\"mt-1 text-right\",attrs:{\"background\":\"\",\"current-page\":_vm.queryInit.pageNo,\"page-sizes\":[10, 20, 30, 40],\"page-size\":_vm.queryInit.pageSize,\"layout\":\"total, sizes, prev, pager, next, jumper\",\"total\":_vm.queryInit.total},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}}),_c('el-button',{on:{\"click\":_vm.onAdd}},[_vm._v(\"添加\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <el-dialog fullscreen title=\"商品列表\" :visible.sync=\"dialogTableVisible\" @close=\"onClose\">\r\n    <el-table :data=\"goodsList\" size=\"small\" @selection-change=\"handleSelectionChange\">\r\n      <el-table-column type=\"selection\" width=\"55\" />\r\n      <el-table-column property=\"name\" label=\"名称\" />\r\n    </el-table>\r\n    <!-- 分页 -->\r\n    <el-pagination\r\n      class=\"mt-1 text-right\"\r\n      background\r\n      :current-page=\"queryInit.pageNo\"\r\n      :page-sizes=\"[10, 20, 30, 40]\"\r\n      :page-size=\"queryInit.pageSize\"\r\n      layout=\"total, sizes, prev, pager, next, jumper\"\r\n      :total=\"queryInit.total\"\r\n      @size-change=\"handleSizeChange\"\r\n      @current-change=\"handleCurrentChange\"\r\n    />\r\n    <el-button @click=\"onAdd\">添加</el-button>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'addGoodsCmp',\r\n\r\n  // eslint-disable-next-line \r\n  props: ['addGoodsVisible'],\r\n\r\n  data () {\r\n    return {\r\n      goodsList: [],\r\n      dialogTableVisible: false,\r\n      queryInit: {\r\n        pageNo: 1,\r\n        pageSize: 10,\r\n        total: 0,\r\n      },\r\n      selectGoodsList: [], // 选定的商品\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    addGoodsVisible (newVal) {\r\n      this.dialogTableVisible = newVal\r\n      this.apiProductQuery()\r\n    }\r\n  },\r\n\r\n  created () {\r\n  },\r\n\r\n  methods: {\r\n    // 关闭事件\r\n    onClose () {\r\n      this.$emit('close')\r\n    },\r\n    handleSizeChange (pageSize) {\r\n      this.queryInit.pageSize = pageSize\r\n      this.apiProductQuery()\r\n    },\r\n    handleCurrentChange (pageNo) {\r\n      console.log(pageNo)\r\n      this.queryInit.pageNo = pageNo\r\n      this.apiProductQuery()\r\n    },\r\n    // 选择的商品\r\n    handleSelectionChange (e) {\r\n      this.selectGoodsList = e\r\n    },\r\n    // 点击添加\r\n    onAdd () {\r\n      this.$emit('selectGoods', this.selectGoodsList)\r\n      this.onClose()\r\n    },\r\n\r\n    // 私有方法------------------\r\n    async apiProductQuery () {\r\n      const data = {\r\n        ...this.queryInit\r\n      }\r\n      const res = await this.$http.post(this.$api.productQuery, data)\r\n      this.goodsList = res.data.data.list\r\n      this.queryInit = res.data.data\r\n      this.queryInit.pageNo = res.data.data.pageNum\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  \r\n</style>\r\n","import mod from \"-!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./add_goods_cmp.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./add_goods_cmp.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./add_goods_cmp.vue?vue&type=template&id=18953668&scoped=true&\"\nimport script from \"./add_goods_cmp.vue?vue&type=script&lang=js&\"\nexport * from \"./add_goods_cmp.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"18953668\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div>\r\n    <layout-box :one=\"$route.query.id ? '编辑活动' : '新增活动'\">\r\n      <el-form ref=\"ruleForm\" label-width=\"100px\" size=\"small\" :model=\"activity\" :rules=\"rules\">\r\n        <el-form-item label=\"活动名称：\" prop=\"name\">\r\n          <el-input v-model=\"activity.name\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"活动时间：\" prop=\"activityBeginTime\">\r\n          <el-date-picker v-model=\"activityTime\" type=\"datetimerange\" range-separator=\"至\" start-placeholder=\"开始日期\" end-placeholder=\"结束日期\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"活动背景图：\">\r\n          <el-upload action=\"http-request\" :http-request=\"onUpload\" list-type=\"picture-card\" :on-remove=\"onRemove\" :file-list=\"activity.background\" :limit=\"1\" multiple>\r\n            <i class=\"el-icon-plus\"></i>\r\n          </el-upload>\r\n        </el-form-item>\r\n        <el-form-item label=\"角标：\">\r\n          <el-upload action=\"http-request\" :http-request=\"onUploadIcon\" list-type=\"picture-card\" :on-remove=\"onRemoveIcon\" :file-list=\"activity.icon\" :limit=\"1\" multiple>\r\n            <i class=\"el-icon-plus\"></i>\r\n          </el-upload>\r\n        </el-form-item>\r\n        <el-form-item label=\"是否显示在页面上：\" prop=\"scope\">\r\n          <el-radio v-model=\"activity.shopModule\" :label=\"0\">否</el-radio>\r\n          <el-radio v-model=\"activity.shopModule\" :label=\"1\">是</el-radio>\r\n        </el-form-item>\r\n        <el-form-item label=\"适用范围：\" prop=\"scope\">\r\n          <el-radio-group v-model=\"activity.scope\" @change=\"onSource\">\r\n            <el-radio label=\"0\">所有商城</el-radio>\r\n            <el-radio label=\"2\">所有小超</el-radio>\r\n            <el-radio label=\"4\">平台</el-radio>\r\n            <el-radio label=\"5\">自营店铺</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item v-if=\"activity.scope\" label=\"活动分类：\" prop=\"type\">\r\n          <el-select v-model=\"activity.type\" placeholder=\"请选择\">\r\n            <el-option v-for=\"item in activityType\" :key=\"item.id\" :label=\"item.name\" :value=\"item.type\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item v-if=\"activity.scope\" label=\"活动适用对象：\" prop=\"rules\">\r\n          <el-select v-model=\"activity.rules\" placeholder=\"请选择\">\r\n            <el-option v-for=\"item in couponRules\" :key=\"item.id\" :label=\"item.ruleName\" :value=\"item.rules\" />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n    </layout-box>\r\n\r\n    <el-card v-if=\"activity.type === 1\" class=\"goods_ground\">\r\n      <activity-add-cmp :activityScope=\"activity.scope\" :activityData=\"activityData\" @onSubmit=\"onCouponsSubmit\" @onSave=\"onCouponsSave\" />\r\n    </el-card>\r\n  \r\n    <el-card v-else-if=\"activity.type === 2\" class=\"goods_ground\">\r\n      <div slot=\"header\"><span>选择的商品</span></div>\r\n      <el-table :data=\"goodsList\" size=\"mini\" style=\"width: 100%\">\r\n        <el-table-column prop=\"name\" label=\"名称\" show-overflow-tooltip />\r\n        <el-table-column label=\"原价\" width=\"150\">\r\n          <template slot-scope=\"slot\">\r\n            <el-input v-model=\"slot.row.produPrice\" size=\"mini\">\r\n              <template slot=\"append\">元</template>\r\n            </el-input>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"活动价格\" width=\"150\">\r\n          <template slot-scope=\"slot\">\r\n            <el-input v-model=\"slot.row.activePrice\" size=\"mini\">\r\n              <template slot=\"append\">元</template>\r\n            </el-input>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"需要几人成功\" width=\"130\">\r\n          <template slot-scope=\"slot\">\r\n            <el-input v-model=\"slot.row.clustersNumber\" size=\"mini\">\r\n              <template slot=\"append\">人</template>\r\n            </el-input>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"活动持续时间\" width=\"350\">\r\n          <template slot-scope=\"slot\">\r\n            <div class=\"goods_time\">\r\n              <el-input v-model=\"slot.row.activeTimeDay\" size=\"mini\" @input=\"onActiveTime(slot)\">\r\n                <template slot=\"append\">天</template>\r\n              </el-input>\r\n              <el-input v-model=\"slot.row.activeTimeHour\" size=\"mini\" @input=\"onActiveTime(slot)\">\r\n                <template slot=\"append\">时</template>\r\n              </el-input>\r\n              <el-input v-model=\"slot.row.activeTimeMin\" size=\"mini\" @input=\"onActiveTime(slot)\">\r\n                <template slot=\"append\">分</template>\r\n              </el-input>\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\">\r\n          <template slot-scope=\"slot\">\r\n            <el-button size=\"mini\" @click=\"onDelete(slot)\">删除</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <div class=\"add\" @click=\"addGoodsVisible = true\">\r\n        <i class=\"el-icon-plus\" />\r\n        <span>添加商品类目</span>\r\n      </div>\r\n      <el-button v-if=\"$route.query.id\" type=\"primary\" @click=\"onSave\">保存</el-button>\r\n      <el-button v-else type=\"primary\" @click=\"onSubmit\">添加</el-button>\r\n    </el-card> \r\n    \r\n    <addGoods-cmp :addGoodsVisible=\"addGoodsVisible\" @close=\"onClose\" @selectGoods=\"onSelectGoods\" />\r\n    <image-compressor-cmp ref=\"imageCompressorCmp\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport LayoutBox from '@/components/LayoutBox/index'\r\nimport activityAddCmp from '@/components/activity_cmp/add.vue'\r\nimport imageCompressorCmp from '@/components/image_compressor_cmp/index.vue'\r\nimport addGoodsCmp from '../cmp/add_goods_cmp.vue'\r\n\r\nexport default {\r\n  name: 'admMarketingActivitiesAdd',\r\n\r\n  components: {\r\n    LayoutBox,\r\n    addGoodsCmp,\r\n    activityAddCmp,\r\n    imageCompressorCmp\r\n  },\r\n\r\n  mixins: [\r\n  ],\r\n\r\n  data () {\r\n    return {\r\n      activity: {\r\n        name: '', // 活动名\r\n        activityBeginTime: '', // 活动开始时间\r\n        activityEndTime: '', // 活动结束时间\r\n        scope: '', // 活动适用范围：0：平台 1：商户 2:两者都可\r\n        type: '', // 活动分类\r\n        rules: '', // 活动适用对象\r\n        background: [], // 活动背景图\r\n        icon: [], // 角标\r\n        shopModule: 0,\r\n      },\r\n      rules: {\r\n        name: [\r\n          { required: true, message: '请输入活动名称', trigger: 'blur' },\r\n        ],\r\n        activityBeginTime: [\r\n          { required: true, message: '请选择活动时间', trigger: 'change' },\r\n        ],\r\n        scope: [\r\n          { required: true, message: '请选择适用范围', trigger: 'change' },\r\n        ],\r\n        type: [\r\n          { required: true, message: '请选择活动分类', trigger: 'change' },\r\n        ],\r\n        rules: [\r\n          { required: true, message: '请选择适用对象', trigger: 'change' },\r\n        ],\r\n      },\r\n      activityTime: [], // 活动时间需要解析开始和结束\r\n      goodsList: [], // 已关联的商品\r\n\r\n      // 私有变量\r\n      activityType: [], // 活动类型\r\n      couponRules: [], // 获取的活动对象\r\n      addGoodsVisible: false, // 添加商品列表窗口\r\n      activityData: {}, // 活动数据\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    // 解析活动开始和结束\r\n    activityTime (newvalue) {\r\n      this.activity.activityBeginTime = newvalue[0]\r\n      this.activity.activityEndTime = newvalue[1]\r\n    },\r\n  },\r\n\r\n  async created () {\r\n    // 如果有id就是编辑页面\r\n    if (this.$route.query.id) {\r\n      await this.apiGetActivityDetail()\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    // 点击提交\r\n    async onSubmit () {\r\n      if (this._formValidate()) {\r\n        const data = {\r\n          activity: this.activity,\r\n          activityPointBuys: this.goodsList\r\n        }\r\n        const res = await this.$http.post(this.$api.insertPointBuyProduct, data)\r\n        if (res.data.success) {\r\n          this.$message.success('添加成功')\r\n          this.$router.go(-1)\r\n        } else {\r\n          this.$message.error(res.data.msg)\r\n        }\r\n      }\r\n    },\r\n    // 点击保存\r\n    async onSave () {\r\n      if (this._formValidate()) {\r\n        let data = {\r\n          activity: this.activity,\r\n          activityPointBuys: this.goodsList\r\n        }\r\n        data = JSON.parse(JSON.stringify(data))\r\n        try {\r\n          data.activity.background = this.activity.background[0].url\r\n          data.activity.icon = this.activity.icon[0].url\r\n        } catch (error) {\r\n          data.activity.background = ''\r\n          data.activity.icon = ''\r\n          console.error('手动抛出错误在除了卡劵需要背景图之外')\r\n        }\r\n        const res = await this.$http.post(this.$api.updatePointBuyProduct, data)\r\n        if (res.data.success) {\r\n          this.$message.success('添加成功')\r\n          this.$router.go(-1)\r\n        } else {\r\n          this.$message.error(res.data.msg)\r\n        }\r\n      }\r\n    },\r\n    // 关闭添加商品窗口\r\n    onClose () {\r\n      this.addGoodsVisible = false\r\n    },\r\n    // 选择商品添加到父页面\r\n    onSelectGoods (e) {\r\n      // 先获取已有商品的id\r\n      const goodIdList = this.goodsList.map((item) => item.produId)\r\n      // 将添加的新添加的商品循环\r\n      e.forEach(element => {\r\n        // 如果没有重复就添加入已有商品列表\r\n        if (goodIdList.indexOf(element.id) < 0) {\r\n          element.produId = element.id\r\n          element.id = ''\r\n          this.goodsList.push(element)\r\n        }\r\n      })\r\n    },\r\n    // 解析活动持续时间\r\n    onActiveTime (slot) {\r\n      slot.row.activeTime = `${slot.row.activeTimeDay || 0}天${slot.row.activeTimeHour || 0}时${slot.row.activeTimeMin || 0}分`\r\n    },\r\n    // 点击删除\r\n    onDelete (slot) {\r\n      this.goodsList.splice(slot.$index, 1)\r\n    },\r\n    // 切换适用范围\r\n    async onSource (e) {\r\n      this.activity.type = ''\r\n      await this.apiGetActivPageParam(e)\r\n    },\r\n    // 点击优惠券的提交\r\n    async onCouponsSubmit (data) {\r\n      await this.$refs.ruleForm.validate(async (valid) => {\r\n        if (valid) {\r\n          data = {\r\n            ...data,\r\n            activity: this.activity,\r\n          }\r\n          data = JSON.parse(JSON.stringify(data))\r\n          try {\r\n            data.activity.background = this.activity.background[0].url\r\n            data.activity.icon = this.activity.icon[0].url\r\n          } catch (error) {\r\n            console.error('手动抛出错误在除了卡劵需要背景图之外')  \r\n          }\r\n          console.log('data', data)\r\n          // return false\r\n          const res = await this.$http.post(this.$api.insertActivity, data)\r\n          if (res.data.success) {\r\n            this.$message.success('添加成功')\r\n            this.$router.go(-1)\r\n          } else {\r\n            this.$message.error(res.data.msg)\r\n          }\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    // 点击优惠券的保存\r\n    async onCouponsSave (data) {\r\n      await this.$refs.ruleForm.validate(async (valid) => {\r\n        if (valid) {\r\n          data = {\r\n            ...data,\r\n            activity: this.activity,\r\n          }\r\n          try {\r\n            data.activity.background = this.activity.background[0].url\r\n            data.activity.icon = this.activity.icon[0].url\r\n          } catch (error) {\r\n            console.error('手动抛出错误在除了卡劵需要背景图之外')  \r\n          }\r\n          const res = await this.$http.post(this.$api.updateCouponActivity, data)\r\n          if (res.data.success) {\r\n            this.$message.success('保存成功')\r\n            this.$router.go(-1)\r\n          } else {\r\n            this.$message.error(res.data.msg)\r\n          }\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    // 自定义覆盖图片上传方法\r\n    async onUpload (params) {\r\n      const file = params.file\r\n      const isJPG = file.type === 'image/jpeg' || file.type === 'image/png'\r\n      if (!isJPG) {\r\n        this.$message.error('上传的图标只能是 JPG/PNG 格式!')\r\n        return\r\n      }\r\n      await this.apiUpload(file)\r\n    },\r\n    // 移除图片时的钩子\r\n    onRemove (file, fileList) {\r\n      this.activity.background = []\r\n    },\r\n    // 自定义覆盖图片上传方法\r\n    async onUploadIcon (params) {\r\n      const file = params.file\r\n      const isJPG = file.type === 'image/jpeg' || file.type === 'image/png'\r\n      if (!isJPG) {\r\n        this.$message.error('上传的图标只能是 JPG/PNG 格式!')\r\n        return\r\n      }\r\n      await this.apiUploadIcon(file)\r\n    },\r\n    // 移除图片时的钩子\r\n    onRemoveIcon (file, fileList) {\r\n      this.activity.icon = []\r\n    },\r\n\r\n    // 私有方法-------------------------------------------\r\n    // 获取活动获取页面选项值\r\n    async apiGetActivPageParam (scope) {\r\n      const res = await this.$http.get(`${this.$api.activityGetActivPageParam}?scope=${scope}`) // 活动适用范围：0：全商城活动 1：商城商户活动 2: 全小超活动 3：小超店铺 4: 全平台得活动\r\n      this.activityType = res.data.data.activityTypes\r\n      this.couponRules = res.data.data.activityRules\r\n    },\r\n    // 编辑时获取的数据\r\n    async apiGetActivityDetail () {\r\n      const res = await this.$http.get(`${this.$api.getActivityDetail}?activeId=${this.$route.query.id}&type=${this.$route.query.type}`)\r\n      switch (res.data.data.activity.type) {\r\n        case 2:\r\n          this.goodsList = res.data.data.activityPointBuys.map((item) => {\r\n            item.name = item.produName\r\n            item.activeTimeDay = item.activeTime.split('天')[0]\r\n            item.activeTimeHour = item.activeTime.split('天')[1].split('时')[0]\r\n            item.activeTimeMin = item.activeTime.split('天')[1].split('时')[1].split('分')[0]\r\n            return item\r\n          })\r\n          break\r\n        case 1:\r\n          this.activityData = res.data.data\r\n          break\r\n        default:\r\n          break\r\n      }\r\n      this.activity = res.data.data.activity\r\n      if (res.data.data.activity.background) {\r\n        this.activity.background = [{ url: res.data.data.activity.background }]\r\n      } else {\r\n        this.activity.background = []\r\n      }\r\n      if (res.data.data.activity.icon) {\r\n        this.activity.icon = [{ url: res.data.data.activity.icon }]\r\n      } else {\r\n        this.activity.icon = []\r\n      }\r\n      await this.apiGetActivPageParam(this.activity.scope)\r\n      this.activityTime.push(res.data.data.activity.activityBeginTime)\r\n      this.activityTime.push(res.data.data.activity.activityEndTime)\r\n    },\r\n    // 提交时验证表单\r\n    _formValidate () {\r\n      let isFormValidate = false\r\n      if (this.goodsList.length === 0) {\r\n        this.$message.error('请选择商品')\r\n        return isFormValidate\r\n      }\r\n      this.goodsList.map((item) => {\r\n        if (\r\n          item.activeTime === '' ||\r\n          item.activeTime === undefined ||\r\n          item.clustersNumber === '' ||\r\n          item.clustersNumber === undefined ||\r\n          item.activePrice === '' ||\r\n          item.activePrice === undefined ||\r\n          item.produPrice === '' ||\r\n          item.produPrice === undefined\r\n        ) {\r\n          this.$message.error('请填写完整')\r\n          throw SyntaxError('请填写完整')\r\n        }\r\n      })\r\n      this.$refs.ruleForm.validate((valid) => {\r\n        if (valid) {\r\n          isFormValidate = true\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n      return isFormValidate\r\n    },\r\n    // 活动背景图片上传\r\n    async apiUpload (file) {\r\n      const formData = await this.$refs.imageCompressorCmp._imageCompressor(file)\r\n      this.$http.post('/common/oss/uploadFile', formData)\r\n        .then((res) => {\r\n          if (res.data.success) {\r\n            this.activity.background.push({ url: res.data.data.webUrl })\r\n          } else {\r\n            this.$message.error(res.data.msg)\r\n          }\r\n        })\r\n    },\r\n    // 角标图片上传\r\n    async apiUploadIcon (file) {\r\n      const formData = await this.$refs.imageCompressorCmp._imageCompressor(file)\r\n      this.$http.post('/common/oss/uploadFile', formData)\r\n        .then((res) => {\r\n          if (res.data.success) {\r\n            this.activity.icon.push({ url: res.data.data.webUrl })\r\n          } else {\r\n            this.$message.error(res.data.msg)\r\n          }\r\n        })\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .goods_ground{\r\n    margin-top: 15px;\r\n    .goods_time{\r\n      display: flex;\r\n      align-items: center;\r\n    }\r\n  }\r\n  .add{\r\n    padding-top: 30px;\r\n    text-align: center;\r\n    font-size: 15px;\r\n    margin: auto;\r\n  }\r\n</style>\r\n","import mod from \"-!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./add.vue?vue&type=template&id=7de9a8e4&scoped=true&\"\nimport script from \"./add.vue?vue&type=script&lang=js&\"\nexport * from \"./add.vue?vue&type=script&lang=js&\"\nimport style0 from \"./add.vue?vue&type=style&index=0&id=7de9a8e4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7de9a8e4\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/_sass-loader@8.0.2@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=style&index=0&id=7de9a8e4&lang=scss&scoped=true&\""],"sourceRoot":""}