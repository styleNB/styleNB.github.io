(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47676a8c"],{"4cc3":function(e,t,i){"use strict";i("d42f")},"72cd":function(e,t,i){"use strict";var a=i("bbcf"),r=i("0ecc").some,o=i("c534"),l=i("e9a9"),s=o("some"),n=l("some");a({target:"Array",proto:!0,forced:!s||!n},{some:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},a937:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"e",(function(){return o})),i.d(t,"d",(function(){return r})),i.d(t,"c",(function(){return l})),i.d(t,"b",(function(){return s}));i("4318"),i("957b"),i("b4e6"),i("6a22"),i("2e4f"),i("80cf");var a={methods:{addAll:function(){for(var e=0,t=0,i=0;i<this.$refs.AddGoodsCmp.$data.multipleSelection.length;i++)this.goodsAndActivity.includes(this.$refs.AddGoodsCmp.$data.multipleSelection[i])?t++:(e++,this.$refs.AddGoodsCmp.$data.multipleSelection[i].prodId=this.$refs.AddGoodsCmp.$data.multipleSelection[i].id,this.$refs.AddGoodsCmp.$data.multipleSelection[i].id="",this.goodsAndActivity.push(this.$refs.AddGoodsCmp.$data.multipleSelection[i]));0!==t&&this.$notify.error({title:"错误",message:"有".concat(t,"个重复了")}),0!==e&&(this.$message.success("有".concat(e,"个添加成功")),this.dialogVisible=!1)},handleCurrentChange:function(){},onOldUpdate:function(e){this.oldUpdateIndex=e.$index},onUpdate:function(e){this.updateIndex=e.$index},onOldSave:function(){this.oldUpdateIndex=""},onSave:function(e){this.updateIndex=""},onDelete:function(e){this.goodsAndActivity.splice(e.$index,1)},onAddGoods:function(){this.dialogVisible=!0}}},r={methods:{uploadFile:function(e){var t=this._uploadFile(e);if(t)return this.$http.post("/common/oss/uploadFile",t).then((function(e){return e.data.data.webUrl}))},_uploadFile:function(e){var t="image/jpeg"===e.file.type||"image/png"===e.file.type,i=e.file.size/1024/1024<10;if(!t)return this.$message.error("上传头像图片只能是 JPG/PNG 格式!"),!1;if(!i)return this.$message.error("上传头像图片大小不能超过 10MB!"),!1;var a=new FormData;return a.append("file",e.file),a}}},o={methods:{_validationNumber:function(e){return e=e.replace(/[^\d.]/g,""),e=e.replace(/^\./g,""),e=e.replace(/\.{2,}/g,"."),e=e.replace(".","$#$").replace(/\./g,"").replace("$#$","."),e},_verifyNumber:function(e){return e=e.replace(/[^\d]/g,""),e},_validationMoney:function(e){return e=e.replace(/[^\d.]/g,""),e=e.replace(/^0\d+|^\./g,""),e=e.replace(/\.{2,}/g,"."),e=e.replace(".","$#$"),e=e.replace(/\./g,""),e=e.replace("$#$","."),e=e.replace(/^(\d+)\.(\d\d).*$/,"$1.$2"),e}}},l={methods:{addAll:function(){for(var e=0,t=0,i=0;i<this.$refs.AddGoodsCmp.$data.multipleSelection.length;i++)this.goodsAndActivity.includes(this.$refs.AddGoodsCmp.$data.multipleSelection[i])?t++:(e++,this.$refs.AddGoodsCmp.$data.multipleSelection[i].samllProdId=this.$refs.AddGoodsCmp.$data.multipleSelection[i].id,this.goodsAndActivity.push(this.$refs.AddGoodsCmp.$data.multipleSelection[i]));0!==t&&this.$notify.error({title:"错误",message:"有".concat(t,"个重复了")}),0!==e&&(this.$message.success("有".concat(e,"个添加成功")),this.dialogVisible=!1)},handleCurrentChange:function(){},onOldUpdate:function(e){this.oldUpdateIndex=e.$index},onUpdate:function(e){this.updateIndex=e.$index},onOldSave:function(){this.oldUpdateIndex=""},onSave:function(e){this.updateIndex=""},onDelete:function(e){this.goodsAndActivity.splice(e.$index,1)},onAddGoods:function(){this.dialogVisible=!0}}},s={methods:{_export2Excel:function(e,t,a){var r=this;Promise.resolve().then(function(){var o=i("4bf8"),l=o.export_json_to_excel,s=r.formatJson(a,e);l(t,s,"统计")}.bind(null,i)).catch(i.oe)},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))}}}},d42f:function(e,t,i){},fb28:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{"min-width":"650px"}},[i("el-breadcrumb",{staticClass:"mb-2",attrs:{separator:"/"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),i("el-breadcrumb-item",[i("a",{attrs:{href:"/"}},[e._v("商品添加")])])],1),i("el-card",{staticClass:"p-1",attrs:{"body-style":{padding:"10px"}}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("span",[e._v("商品信息填写")])]),i("div",{staticStyle:{"min-width":"650px"}},[i("el-form",{ref:"ruleForm",attrs:{model:e.model,"label-width":"110px",rules:e.rules}},[i("el-form-item",{attrs:{label:"商品分类:",prop:"categoryId"}},[i("el-cascader",{ref:"cascaderAddr",attrs:{options:e.model.catelist,props:{expandTrigger:"hover"},size:"mini"},on:{change:e.parentCateChanged},model:{value:e.model.categoryId,callback:function(t){e.$set(e.model,"categoryId",t)},expression:"model.categoryId"}})],1),i("el-form-item",{attrs:{label:"名称:",prop:"name"}},[i("el-input",{staticClass:"commAdd",attrs:{size:"small",placeholder:"请输入商品名称"},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),i("el-form-item",{attrs:{label:"商品标题:",prop:"title"}},[i("el-input",{staticClass:"commAdd",attrs:{placeholder:"请输入商品标题",size:"small"},model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}})],1),i("el-form-item",{attrs:{label:"商品货号:",prop:"code"}},[i("el-input",{staticClass:"commAdd",attrs:{size:"small",placeholder:"请输入商品货号"},model:{value:e.model.code,callback:function(t){e.$set(e.model,"code",t)},expression:"model.code"}})],1),i("el-form-item",{attrs:{label:"规格:",required:""}},[i("section",[e._l(e.attributeItem,(function(t,a){return i("div",{key:a,staticClass:"spec-line"},[i("el-dialog",{attrs:{title:"库存数量",visible:e.dialogValueNum,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogValueNum=t}}},[i("el-input",{model:{value:t.inputValueNum,callback:function(i){e.$set(t,"inputValueNum",e._n(i))},expression:"item.inputValueNum"}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogValueNum=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSave(a)}}},[e._v("确 定")])],1)],1),i("div",{staticClass:"ml-2"},[t.status?e._e():i("span",[e._v(e._s(t.keyName))]),t.status?i("el-input",{staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"输入产品规格"},model:{value:t.inputKeyName,callback:function(i){e.$set(t,"inputKeyName",i)},expression:"item.inputKeyName"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-check",type:"primary"},on:{click:function(t){return e.onSaveAttributeKey(a)}},slot:"append"})],1):i("i",{staticClass:"icon el-icon-edit",on:{click:function(i){return e.onUpdateSpec(t)}}})],1),i("div",{staticClass:"ml-2"},[e._l(t.keyValue,(function(t,r){return i("el-tag",{key:r,attrs:{closable:""},on:{close:function(t){return e.onDelSpecTag(r,a)}}},[e._v("属性："+e._s(t.valueName))])})),i("el-input",{staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"输入产品属性"},model:{value:t.inputKeyValue,callback:function(i){e.$set(t,"inputKeyValue",i)},expression:"item.inputKeyValue"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-check",type:"primary"},on:{click:function(t){return e.onAddSpecTag(a)}},slot:"append"})],1)],2),i("i",{staticClass:"icon el-icon-circle-close spec-deleted",on:{click:function(t){return e.onDelSpec(a)}}}),i("el-divider")],1)})),i("div",{staticClass:"add-spec"},[i("el-button",{attrs:{size:"small",type:"primary",disabled:e.attributeItem.length>=3},on:{click:e.onAddSpec}},[e._v("添加规格项目")])],1)],2)]),i("el-form-item",{attrs:{label:"属性",required:""}},[i("el-table",{attrs:{data:e.attributeItemTable,border:"",size:"mini"}},[e._l(e.attributeItem,(function(t,a){return i("el-table-column",{key:a,attrs:{label:t.keyName,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.attributeArr[a]))])]}}],null,!0)})})),i("el-table-column",{attrs:{label:"原价",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{model:{value:t.row.originalPrice,callback:function(i){e.$set(t.row,"originalPrice",i)},expression:"scope.row.originalPrice"}})]}}])}),i("el-table-column",{attrs:{label:"现价",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{model:{value:t.row.price,callback:function(i){e.$set(t.row,"price",i)},expression:"scope.row.price"}})]}}])}),i("el-table-column",{attrs:{label:"库存",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{model:{value:t.row.stock,callback:function(i){e.$set(t.row,"stock",i)},expression:"scope.row.stock"}})]}}])}),i("el-table-column",{attrs:{label:"配图",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http-request","http-request":function(i){return e.onUploadSectionFile(i,t)},"show-file-list":!1}},[t.row.imgUrl?i("el-image",{staticClass:"avatar",attrs:{src:t.row.imgUrl,fit:"contain"}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)]}}])})],2)],1),i("el-form-item",{attrs:{label:"主图上传：",prop:"imageUrl"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http-request","http-request":e.uploadSectionFile,"show-file-list":!1}},[e.model.imageUrl?i("el-image",{staticClass:"avatar",attrs:{src:e.model.imageUrl,fit:"contain"}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1),i("el-form-item",{attrs:{label:"视频上传：",prop:"videoUrl"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http-request","show-file-list":!1,"http-request":e.beforeUploadVideo,accept:".mp4,.qlv,.qsv,.ogg,.flv,.avi,.wmv,.rmvb"}},[e.model.videoUrl?i("video",{staticClass:"avatar",attrs:{src:e.model.videoUrl,controls:""}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),i("el-form-item",{attrs:{label:"商品详情:",prop:"describes"}},[i("tinymce",{staticStyle:{"min-width":"590px"},attrs:{height:300},model:{value:e.model.describes,callback:function(t){e.$set(e.model,"describes",t)},expression:"model.describes"}})],1),i("el-form-item",{attrs:{label:"物流包邮:"}},[i("el-select",{attrs:{placeholder:"包邮"},model:{value:e.model.logisticsType,callback:function(t){e.$set(e.model,"logisticsType",t)},expression:"model.logisticsType"}},e._l(e.model.options2,(function(e){return i("el-option",{key:e.logistics,attrs:{label:e.label,value:e.logistics}})})),1)],1),i("el-form-item",{staticClass:"text-center"},[i("el-button",{staticClass:"goods",attrs:{type:"submit"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v("提交审核")])],1)],1)],1)]),i("image-compressor-cmp",{ref:"imageCompressorCmp"})],1)},r=[],o=(i("7f64"),i("957b"),i("72cd"),i("b4e6"),i("6a22"),i("5f89"),i("6a61"),i("2e91")),l=i("8256"),s=i("a937"),n=i("6c38"),c=i("d901"),d={components:{imageCompressorCmp:c["a"],Tinymce:l["a"]},data:function(){return{model:{item:[],categoryName:"",videoImageUrl:"",picList:[],imageName:"",imageUrl:"",advertisingUrl:"",videoUrl:"",videoName:"",logisticsType:0,catelist:[],cateProps:{expandTrigger:"hover",label:"categoryName",value:"id",children:"trees",checkStrictly:!0},categoryId:[],title:"",code:"",classify:"",sort:"",state:0,options2:[{logistics:0,label:"包邮"},{logistics:1,label:"按规则计算邮费"}],dialogImageUrl:"",dialogVisible:!1,textarea:""},rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],categoryId:[{required:!0,message:"请选择分类",trigger:"blur"}],title:[{required:!0,message:"请填写商品介绍",trigger:"change"}],code:[{required:!0,message:"请填写商品货号",trigger:"change"}],costPrice:[{required:!0,message:"请输入售价价格",trigger:"change"}],imageUrl:[{required:!0,message:"请添加商品图片",trigger:"change"}],describes:[{required:!0,message:"请填写商品详情",trigger:"blur"}],inventory:[{required:!0,message:"请填写商品详情",trigger:"blur"}]},attributeItem:[],keyValue:"",attributeItemTable:[],dialogValueNum:!1,saveInventoryIndex:"",saveInventoryAttributeIndex:""}},mixins:[s["e"],n["a"]],methods:{parentCateChanged:function(e){console.log(e);var t=this.$refs["cascaderAddr"].getCheckedNodes()[0].pathLabels;console.log(this.$refs["cascaderAddr"].getCheckedNodes()[0].pathLabels);var i=t.join("/");this.model.categoryName=i.split("/")[1]},handleLogin:function(){var e=this;if(0===this.attributeItemTable.length)return this.$message.error("规格不能为空"),!1;var t=!1;if(this.attributeItemTable.some((function(e){if(""===e.price||""===e.imgUrl||""===e.stock||""===e.originalPrice)return!0;t=!0})),!t)return this.$message.error("请把规格表格填完"),!1;if(this.model.categoryId.length<2)return this.$notify.error("请选择二级分类");var i=JSON.stringify(this.model),a=JSON.parse(i);a.categoryId=this.model.categoryId[1],this.$refs.ruleForm.validate((function(t){if(!t)return e.$notify.error("表单填写不完整");var i=e.$loading(e.$optionsCmp);a.describes=e._mixinsDescribesAppendH5(a.describes),a.items=e.attributeItem;var r=e.attributeItemTable.map((function(e){return{attrSymbolNo:e.attributeArr.join(","),price:e.price,imgUrl:e.imgUrl,stock:e.stock,originalPrice:e.originalPrice}}));a.skus=r,a.type=0,console.log("dataJson",a),i.close(),e.$http.post(e.$api.productInsert,a).then((function(t){i.close(),t.data.success?(e.$message.success("提交成功"),e.$router.push("/commo/list")):e.$message.error(t.data.msg)}))}))},getCateList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/woho/product/category/findByTree/".concat(localStorage.getItem("userArea")));case 2:i=t.sent,e.model.catelist=e.getTreeData(i.data.data);case 4:case"end":return t.stop()}}),t)})))()},getTreeData:function(e){for(var t=0;t<e.length;t++)e[t].label=e[t].categoryName,e[t].value=e[t].id,e[t].trees.length<1?e[t].children=void 0:e[t].children=this.getTreeData(e[t].trees);return e},onSaveAttributeKey:function(e){if(!this._validAttributeKey(this.attributeItem[e].inputKeyName,this.attributeItem))return!1;this.attributeItem[e].keyName=this.attributeItem[e].inputKeyName,this.attributeItem[e].status=!1},onSave:function(e){var t={valueName:this.attributeItem[this.saveInventoryIndex].inputKeyValue};console.log("this.saveInventoryAttributeIndex",this.saveInventoryAttributeIndex),this.attributeItem[this.saveInventoryIndex].keyValue.push(t),this.attributeItem[this.saveInventoryIndex].inputKeyValue="",this._attributeItemTable(),this.saveInventoryAttributeIndex=""},onUpdateSpec:function(e){e.status=!0,e.keyName=""},onDelSpecTag:function(e,t){this.attributeItem[t].keyValue.splice(e,1),this._attributeItemTable()},onDelSpec:function(e){this.attributeItem.splice(e,1),this._attributeItemTable()}},created:function(){this.getCateList()}},u=d,m=(i("4cc3"),i("5d22")),p=Object(m["a"])(u,a,r,!1,null,"43c1563c",null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-47676a8c.19a62866.js.map