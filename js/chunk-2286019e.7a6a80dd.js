(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2286019e"],{"0cd9":function(e,t,a){"use strict";var i=a("bbcf"),n=a("4c16"),r=a("adc7"),s=a("58e4"),o=a("56be"),l=a("0418"),c=a("a5a1"),u=a("2fb1"),d=a("e4bd"),m=a("9997"),p=a("45a2"),f=a("d922");e.exports=function(e,t,a){var v=-1!==e.indexOf("Map"),h=-1!==e.indexOf("Weak"),b=v?"set":"add",g=n[e],y=g&&g.prototype,k=g,x={},w=function(e){var t=y[e];s(y,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(h&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return h&&!u(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(h&&!u(e))&&t.call(this,0===e?0:e)}:function(e,a){return t.call(this,0===e?0:e,a),this})};if(r(e,"function"!=typeof g||!(h||y.forEach&&!d((function(){(new g).entries().next()})))))k=a.getConstructor(t,e,v,b),o.REQUIRED=!0;else if(r(e,!0)){var S=new k,I=S[b](h?{}:-0,1)!=S,C=d((function(){S.has(1)})),_=m((function(e){new g(e)})),N=!h&&d((function(){var e=new g,t=5;while(t--)e[b](t,t);return!e.has(-0)}));_||(k=t((function(t,a){c(t,k,e);var i=f(new g,t,k);return void 0!=a&&l(a,i[b],{that:i,AS_ENTRIES:v}),i})),k.prototype=y,y.constructor=k),(C||N)&&(w("delete"),w("has"),v&&w("get")),(N||I)&&w(b),h&&y.clear&&delete y.clear}return x[e]=k,i({global:!0,forced:k!=g},x),p(k,e),h||a.setStrong(k,e,v),k}},"3b75":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"min-width":"650px"}},[a("el-breadcrumb",{staticClass:"mb-2",attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("商品编辑")])],1),a("el-card",{staticClass:"p-1",attrs:{"body-style":{padding:"10px"}}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("商品信息填写")])]),a("div",{staticStyle:{"min-width":"650px"}},[a("el-form",{attrs:{model:e.model,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"商品分类："}},[a("el-cascader",{attrs:{options:e.catelist,props:e.cateProps},on:{change:e.parentCateChanged},model:{value:e.model.categoryId,callback:function(t){e.$set(e.model,"categoryId",t)},expression:"model.categoryId"}})],1),a("el-form-item",{attrs:{label:"名称:"}},[a("el-input",{staticClass:"commAdd",attrs:{size:"small",placeholder:"请输入商品名称"},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),a("el-form-item",{attrs:{label:"商品货号:"}},[a("el-input",{staticClass:"commAdd",attrs:{size:"small",placeholder:"请输入商品货号"},model:{value:e.model.code,callback:function(t){e.$set(e.model,"code",t)},expression:"model.code"}})],1),a("el-form-item",{attrs:{label:"商品标题:",prop:"title"}},[a("el-input",{staticClass:"commAdd",attrs:{placeholder:"请输入商品标题",size:"small"},model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}})],1),a("el-form-item",{attrs:{label:"规格"}},[e._l(e.attributeItem,(function(t,i){return a("div",{key:i,staticClass:"spec-line"},[a("el-dialog",{attrs:{title:"库存数量",visible:e.dialogValueNum,width:"30%"},on:{"update:visible":function(t){e.dialogValueNum=t}}},[a("el-input",{model:{value:t.inputValueNum,callback:function(a){e.$set(t,"inputValueNum",e._n(a))},expression:"item.inputValueNum"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogValueNum=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSave(i)}}},[e._v("确 定")])],1)],1),t.keyName?a("div",[a("span",[e._v(e._s(t.keyName))]),a("i",{staticClass:"icon el-icon-edit",on:{click:function(a){return e.onUpdateSpec(t,i)}}})]):a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入规格名",size:"small"},model:{value:e.cacheSpecification.name,callback:function(t){e.$set(e.cacheSpecification,"name",t)},expression:"cacheSpecification.name"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-check",type:"primary",size:"mini"},on:{click:function(a){return e.append(t)}},slot:"append"})],1),a("div",{staticClass:"mt-1 attribute"},[e._l(t.keyValue,(function(t,n){return a("el-tag",{key:n,attrs:{closable:""},on:{close:function(a){return e.delSpecTag(n,t,i)}}},[e._v("属性："+e._s(t.valueName))])})),a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入属性值",size:"small"},model:{value:t.inputKeyValue,callback:function(a){e.$set(t,"inputKeyValue",a)},expression:"item.inputKeyValue"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-check",type:"primary",size:"mini"},on:{click:function(t){return e.onAddSpecTag(i)}},slot:"append"})],1)],2),a("i",{staticClass:"icon el-icon-circle-close spec-deleted",on:{click:function(t){return e.onDelSpec(i)}}}),a("el-divider")],1)})),a("div",{staticClass:"mt-1"},[a("el-button",{attrs:{size:"small",type:"primary",disabled:e.attributeItem.length>=3},on:{click:e.onAddSpec}},[e._v("添加规格项目")])],1)],2),a("el-form-item",[a("el-table",{attrs:{data:e.attributeItemTable,size:"mini",border:"",stripe:""}},[a("el-table-column",{attrs:{label:"商品规格",align:"center"}},e._l(e.attributeItem,(function(t,i){return a("el-table-column",{key:i,attrs:{label:t.keyName,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.attributeArr[i]))])]}}],null,!0)})})),1),a("el-table-column",{attrs:{label:"原价",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.originalPrice,callback:function(a){e.$set(t.row,"originalPrice",a)},expression:"scope.row.originalPrice"}})]}}])}),a("el-table-column",{attrs:{label:"现价",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.price,callback:function(a){e.$set(t.row,"price",a)},expression:"scope.row.price"}})]}}])}),a("el-table-column",{attrs:{label:"库存",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.stock,callback:function(a){e.$set(t.row,"stock",a)},expression:"scope.row.stock"}})]}}])}),a("el-table-column",{attrs:{prop:"imgUrl",label:"配图",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http-request","http-request":function(a){return e.onUploadSectionFile(a,t)},"show-file-list":!1}},[t.row.imgUrl?a("el-image",{staticClass:"avatar",attrs:{src:t.row.imgUrl,fit:"contain"}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)]}}])})],1)],1),a("el-form-item",{attrs:{label:"主图上传：",prop:"imageUrl"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http-request","http-request":e.uploadSectionFile,"show-file-list":!1}},[e.model.imageUrl?a("el-image",{staticClass:"avatar",attrs:{src:e.model.imageUrl,fit:"contain"}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1),a("el-form-item",{attrs:{label:"视频："}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http-request","show-file-list":!1,"http-request":e.beforeUploadVideo,accept:".mp4,.qlv,.qsv,.ogg,.flv,.avi,.wmv,.rmvb"}},[e.model.videoUrl?a("video",{staticClass:"avatar",attrs:{src:e.model.videoUrl,controls:""}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"商品详情:",prop:"describes"}},[a("tinymce",{staticStyle:{"min-width":"590px"},attrs:{height:300},model:{value:e.model.describes,callback:function(t){e.$set(e.model,"describes",t)},expression:"model.describes"}})],1),a("el-form-item",{staticClass:"mt-1",attrs:{label:"物流包邮:"}},[a("el-select",{attrs:{placeholder:"包邮"},model:{value:e.model.logisticsType,callback:function(t){e.$set(e.model,"logisticsType",t)},expression:"model.logisticsType"}},e._l(e.options2,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{staticClass:"text-right"},[a("el-button",{staticClass:"btn",attrs:{type:"success"},on:{click:e.commoEdit}},[e._v("提交审核")])],1)],1)],1)]),a("image-compressor-cmp",{ref:"imageCompressorCmp"})],1)},n=[],r=(a("51d7"),a("3e68"),a("4ec5"),a("7f64"),a("957b"),a("b4e6"),a("1e6a"),a("4d20"),a("6a22"),a("8536"),a("2181"),a("5f89"),a("659e"),a("6a61"),a("2e91")),s=a("8256"),o=a("6c38"),l=a("d901"),c={components:{imageCompressorCmp:l["a"],Tinymce:s["a"]},props:{id:{type:String,default:""}},data:function(){return{addValues:[],cacheSpecification:[],jsonContent:[],catelist:[],cateProps:{expandTrigger:"hover",label:"categoryName",value:"id",children:"trees",checkStrictly:!0},options2:[{value:0,label:"包邮 "},{value:1,label:"按自定义邮费规则"}],model:{imageName:"",imageUrl:"",advertisingUrl:"",item:[],items:[],categoryId:"",title:"",code:"",classify:"",checkList:[],checkList1:[],sort:"",state:null,dialogImageUrl:"",dialogVisible:!1,textarea:""},attributeItemTable:[],attributeItem:[],dialogValueNum:!1,saveInventoryIndex:"",saveInventoryAttributeIndex:""}},mixins:[o["a"]],methods:{append:function(e){if(!this._validAttributeKey(this.cacheSpecification.name,this.model.items))return!1;e.keyName=this.cacheSpecification.name},delSpecTag:function(e,t,a){this.model.items[a].keyValue.splice(e,1),this._assignmentPrices(),console.log("this.model.items",this.model.items)},commoEdit:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.attributeItem){t.next=3;break}return e.$message.error("规格不能为空"),t.abrupt("return",!1);case 3:return e.model.item.map((function(e){e.fields=JSON.parse(e.fields1)})),a=JSON.parse(JSON.stringify(e.model)),a.describes=e._mixinsDescribesAppendH5(a.describes),a.items=e.attributeItem,e.attributeItemTable.map((function(t){if(!t.price)throw e.$message.error("现价不能为空"),SyntaxError("现价为空强制报错停止map");t.attrSymbolNo=t.attributeArr.join(",")})),a.skus=e.attributeItemTable,t.next=11,e.$http.put(e.$api.productUpdate,a);case 11:i=t.sent,i.data.success?(e.$message.success("提交成功"),e.$router.push("/commo/list")):e.$message.error(i.data.msg);case 13:case"end":return t.stop()}}),t)})))()},parentCateChanged:function(e){this.model.categoryId=e[e.length-1]},_fieldsShowItem:function(e){var t=this.model.item.map((function(t){return t.fieldsShow[e]}));return Array.from(new Set(t))},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},handleSelect:function(e){console.log(e)},handleRemove:function(e,t){console.log(e,t)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleChange:function(){console.log(this.cateProps),2===this.cateProps.length&&(this.cateProps=[])},handleCurrentChange:function(e,t,a){console.log(e,t,a,t.currentTarget)},handleEdit:function(e,t){console.log(e,t)},onUpdateSpec:function(e,t){e.keyName=""},onSave:function(e){var t={valueName:this.attributeItem[this.saveInventoryIndex].inputKeyValue};this.attributeItem[this.saveInventoryIndex].keyValue.push(t),this.attributeItem[this.saveInventoryIndex].inputKeyValue="",this._assignmentPrices(),this.saveInventoryAttributeIndex=""},onDelSpec:function(e){this.attributeItem.splice(e,1),this._assignmentPrices()},getTreeData:function(e){for(var t=0;t<e.length;t++)e[t].trees.length<1?e[t].trees=void 0:this.getTreeData(e[t].trees);return e},_assignmentPrices:function(){var e=this;this._attributeItemTable(),this.attributeItemTable=this.attributeItemTable.map((function(t){return console.log("this.model.skus",e.model.skus),e.model.skus.map((function(e){t.attributeArr.join(",")===e.attrSymbolNo&&(t=e,t.attributeArr=e.attrSymbolNo.split(","))})),t}))},getCateList:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/woho/product/category/findByTree/".concat(localStorage.getItem("userArea")));case 2:a=t.sent,e.catelist=e.getTreeData(a.data.data);case 4:case"end":return t.stop()}}),t)})))()},fetch:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("".concat(e.$api.productFindById,"?id=").concat(e.id,"&type=",2));case 2:a=t.sent,e.model=a.data;try{e.model.describes=JSON.parse(e.model.describes).goodsDetailsContent}catch(i){}e.model.items.map((function(t){e.attributeItem.push({keyName:t.keyName,inputKeyName:"",keyValue:t.keyValue,inputValueNum:"",inputKeyValue:"",status:!1})})),e._assignmentPrices();case 7:case"end":return t.stop()}}),t)})))()}},created:function(){this.getCateList(),this.id&&this.fetch()}},u=c,d=(a("9ad4"),a("5d22")),m=Object(d["a"])(u,i,n,!1,null,"cb9deb3e",null);t["default"]=m.exports},"56be":function(e,t,a){var i=a("431d"),n=a("2fb1"),r=a("631e"),s=a("60ce").f,o=a("a330"),l=a("5e0f"),c=o("meta"),u=0,d=Object.isExtensible||function(){return!0},m=function(e){s(e,c,{value:{objectID:"O"+ ++u,weakData:{}}})},p=function(e,t){if(!n(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!r(e,c)){if(!d(e))return"F";if(!t)return"E";m(e)}return e[c].objectID},f=function(e,t){if(!r(e,c)){if(!d(e))return!0;if(!t)return!1;m(e)}return e[c].weakData},v=function(e){return l&&h.REQUIRED&&d(e)&&!r(e,c)&&m(e),e},h=e.exports={REQUIRED:!1,fastKey:p,getWeakData:f,onFreeze:v};i[c]=!0},"5e0f":function(e,t,a){var i=a("e4bd");e.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},6987:function(e,t,a){"use strict";var i=a("60ce").f,n=a("4035"),r=a("ecf6"),s=a("9d80"),o=a("a5a1"),l=a("0418"),c=a("c0ba"),u=a("8e50"),d=a("6921"),m=a("56be").fastKey,p=a("7acd"),f=p.set,v=p.getterFor;e.exports={getConstructor:function(e,t,a,c){var u=e((function(e,i){o(e,u,t),f(e,{type:t,index:n(null),first:void 0,last:void 0,size:0}),d||(e.size=0),void 0!=i&&l(i,e[c],{that:e,AS_ENTRIES:a})})),p=v(t),h=function(e,t,a){var i,n,r=p(e),s=b(e,t);return s?s.value=a:(r.last=s={index:n=m(t,!0),key:t,value:a,previous:i=r.last,next:void 0,removed:!1},r.first||(r.first=s),i&&(i.next=s),d?r.size++:e.size++,"F"!==n&&(r.index[n]=s)),e},b=function(e,t){var a,i=p(e),n=m(t);if("F"!==n)return i.index[n];for(a=i.first;a;a=a.next)if(a.key==t)return a};return r(u.prototype,{clear:function(){var e=this,t=p(e),a=t.index,i=t.first;while(i)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete a[i.index],i=i.next;t.first=t.last=void 0,d?t.size=0:e.size=0},delete:function(e){var t=this,a=p(t),i=b(t,e);if(i){var n=i.next,r=i.previous;delete a.index[i.index],i.removed=!0,r&&(r.next=n),n&&(n.previous=r),a.first==i&&(a.first=n),a.last==i&&(a.last=r),d?a.size--:t.size--}return!!i},forEach:function(e){var t,a=p(this),i=s(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:a.first){i(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!b(this,e)}}),r(u.prototype,a?{get:function(e){var t=b(this,e);return t&&t.value},set:function(e,t){return h(this,0===e?0:e,t)}}:{add:function(e){return h(this,e=0===e?0:e,e)}}),d&&i(u.prototype,"size",{get:function(){return p(this).size}}),u},setStrong:function(e,t,a){var i=t+" Iterator",n=v(t),r=v(i);c(e,t,(function(e,t){f(this,{type:i,target:e,state:n(e),kind:t,last:void 0})}),(function(){var e=r(this),t=e.kind,a=e.last;while(a&&a.removed)a=a.previous;return e.target&&(e.last=a=a?a.next:e.state.first)?"keys"==t?{value:a.key,done:!1}:"values"==t?{value:a.value,done:!1}:{value:[a.key,a.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),a?"entries":"values",!a,!0),u(t)}}},8536:function(e,t,a){"use strict";var i=a("0cd9"),n=a("6987");e.exports=i("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n)},"9ad4":function(e,t,a){"use strict";a("d303")},d303:function(e,t,a){}}]);
//# sourceMappingURL=chunk-2286019e.7a6a80dd.js.map